# 社交平台自动发布系统设计

> 创建日期: 2026-02-04
> 状态: 设计完成，待实现

## 项目概述

为 Sprouty AI 桌面应用添加社交平台自动发布功能，支持用户通过 Agent 或 UI 将内容一键发布到多个社交平台，并提供完整的内容管理能力。

## 核心需求

- **自动化发布**: 使用 Playwright 控制浏览器完成发布操作
- **登录态管理**: 用户手动登录一次，保存登录态供后续使用
- **API 优先**: 有官方 API 的平台（如微信公众号）优先使用 API
- **内容管理**: 查看已发布内容、数据统计、评论管理
- **定时发布**: 支持设置定时发布任务
- **多账号**: 同一平台支持多个账号

## 支持平台

按优先级排序：

1. 小红书
2. 抖音
3. 微信公众号
4. B站
5. 快手
6. 微博
7. 知乎

## 支持内容类型

- 图文笔记/文章
- 短视频
- 长视频（B站）
- 纯文字（微博、知乎、公众号）

## 整体架构

```
┌─────────────────────────────────────────────────────────────────┐
│                    Sprouty AI 桌面应用                          │
│                  (Electron + React UI)                          │
└──────────────────────┬──────────────────────────────────────────┘
                       │ IPC
┌──────────────────────▼──────────────────────────────────────────┐
│                 Electron 主进程                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │           SocialPublisher 内置模块                        │    │
│  │  (@sprouty-ai/shared/social-publisher)                │    │
│  │                                                         │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │    │
│  │  │ 账号管理器   │  │ 内容管理器   │  │ 发布调度器   │     │    │
│  │  │ AccountMgr  │  │ ContentMgr  │  │ Scheduler   │     │    │
│  │  └─────────────┘  └─────────────┘  └─────────────┘     │    │
│  │                                                         │    │
│  │  ┌─────────────────────────────────────────────────┐   │    │
│  │  │          平台适配器 (Platform Adapters)          │   │    │
│  │  │  Xiaohongshu │ Douyin │ WeChat │ Bilibili │ ... │   │    │
│  │  └─────────────────────────────────────────────────┘   │    │
│  │                         │                               │    │
│  │              ┌──────────▼──────────┐                   │    │
│  │              │  Playwright 引擎     │                   │    │
│  │              │  (浏览器自动化)       │                   │    │
│  │              └─────────────────────┘                   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │           MCP Server (social-publisher)                 │    │
│  │  暴露工具给 Agent 调用                                    │    │
│  └─────────────────────────────────────────────────────────┘    │
└──────────────────────────────────────────────────────────────────┘
```

## 设计文档索引

| 文档 | 说明 |
|------|------|
| [01-数据模型.md](./01-数据模型.md) | 账号、内容、发布记录等数据结构 |
| [02-平台适配器.md](./02-平台适配器.md) | 平台适配器接口和各平台特殊处理 |
| [03-MCP工具.md](./03-MCP工具.md) | Agent 可调用的 MCP 工具定义 |
| [04-登录态管理.md](./04-登录态管理.md) | Playwright 集成和登录态存储 |
| [05-UI设计.md](./05-UI设计.md) | Electron 渲染进程 UI 组件 |
| [06-实现计划.md](./06-实现计划.md) | 目录结构和分阶段实现计划 |

## 技术决策

| 项目 | 决策 | 原因 |
|------|------|------|
| 浏览器自动化 | Playwright | 跨平台、API 现代、反检测能力强 |
| 数据存储 | SQLite + 加密文件 | 本地优先、无需服务器 |
| 架构模式 | 内置模块 + MCP Server | 支持 UI 和 Agent 两种调用方式 |
| 登录态 | storageState 加密存储 | 复用 Playwright 原生能力 |
