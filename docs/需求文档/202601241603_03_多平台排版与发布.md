# 多平台排版与发布模块 PRD（小红书 / 抖音 / 公众号）

> 版本：v0.1 草案  
> 关联文档：00_创流CreatorFlow_产品总览、02_图文脚本工作台

---

## 1. 背景与目标

### 1.1 背景

个人创作者往往需要在 **小红书 / 抖音 / 公众号** 之间反复复制粘贴、一条条调整：

- 不同平台的标题长度限制、表情习惯、话题/标签格式不同；
- 封面、首图、视频比例等要求不同；
- 发布与定时功能分散在各家后台。

创流需要提供一个统一的「多平台排版与发布」能力：

- 在一个界面中，为不同平台生成和调整各自的发布版本；
- 尽量自动化适配平台规范，减少手工调整；
- 支持一键或定时发布，并跟踪发布结果。

### 1.2 目标

- 基于脚本工作台的内容，自动生成小红书/抖音/公众号的发布稿；
- 提供平台级别的排版预览和细节调整；
- 支持账号绑定、安全存储、状态检测；
- 支持立即发布与定时发布；
- 为后续的数据模块提供统一的「作品发布记录」。

---

## 2. 核心概念

### 2.1 发布草稿（PublishDraft）

- 从 Script 生成的、针对一个或多个平台的具体发布草稿；
- 包含：
  - 关联 Script / 作品 ID；
  - 平台维度的字段（见下）；
  - 发布状态（未发布 / 发布中 / 已发布 / 失败 / 定时中）。

### 2.2 平台发布视图

- 对同一个 PublishDraft，在 UI 层按平台划分：
  - 小红书视图（图文为主）；
  - 抖音视图（视频/图文+口播为主）；
  - 公众号视图（图文为主）。

---

## 3. 用户流程

### 3.1 从脚本进入发布

1. 用户在脚本工作台中点击「去发布」；
2. 系统弹出/跳转到「发布」界面：
   - 自动选择已支持的平台（小红书/抖音/公众号）；
   - 为每个平台生成一份初始发布草稿（标题、封面、正文等）。

### 3.2 调整各平台发布内容

1. 在「发布」界面按平台 Tab 切换：
   - 小红书：查看封面预览、标题、正文、标签；
   - 抖音：查看视频/轮播图预览、标题、首评文案（可选）；
   - 公众号：查看文章预览（标题、副标题、正文）。
2. 用户可针对每个平台独立修改：
   - 标题文案；
   - 正文细节（例如删除某些不适合平台的段落）；
   - 封面/首图选择；
   - 话题/标签；
   - 发布时间（立即/定时）。

### 3.3 选择发布方式并执行

- 用户可选择：
  - 一键发布：对所有勾选的平台立即发布；
  - 定时发布：为每个平台设置不同时间；
- 部分平台初期如暂不支持完全自动：
  - 降级为「半自动发布」：
    - 系统提供一键复制内容 + 打开对应后台链接；
    - 发布状态需允许用户手动标记为「已发布」。

---

## 4. 功能需求

### 4.1 自动生成平台发布初稿（P0）

从 Script 中提取内容，按平台规则处理：

#### 4.1.1 小红书

- 字段：
  - 标题：基于脚本开头钩子生成，控制在平台限制内；
  - 正文：
    - 使用小红书风格（短段落、Emoji 可选）；
    - 自动插入合适位置的换行与表情；
  - 图片：
    - 从脚本关联素材中推荐 1–9 张作为图文配图；
  - 话题标签：
    - 基于项目话题、脚本关键词和平台热点生成 3–10 个标签；
- 提供小红书风格预览（模拟卡片样式）。

#### 4.1.2 抖音

- 字段：
  - 标题：更偏口语化和吸引眼球，控制字数；
  - 视频内容：
    - v1 可以以「图文轮播」或「待上传视频 + 口播脚本/字幕」为主；
  - 话题标签：
    - 与小红书有交集但做适当调整；
  - 首评文案（可选）：
    - 简短说明或引导互动文案。

#### 4.1.3 公众号

- 字段：
  - 标题 + 副标题（可选）；
  - 正文：
    - 使用结构化排版（H1/H2/H3、小标题、列表、引用等）；
  - 封面图：
    - 推荐 1 张适合作封面的图片；
  - 摘要：
    - 生成 50–120 字的文章摘要。

### 4.2 账号管理与授权（P0）

- 支持绑定小红书 / 抖音 / 公众号账号：
  - 登录方式根据平台实际能力（OAuth / QR 扫码 / Cookie 等）；
- 本地安全存储：
  - 使用加密存储各平台的凭证；
- 状态检测：
  - 显示当前账号是否登录有效；
  - 登录过期时报错或提醒用户重新授权。

### 4.3 发布执行与状态追踪（P0）

- 对于已勾选的平台：
  - 立即发布：
    - 调用平台 API 或通过半自动流程完成发布；
  - 定时发布：
    - 将任务写入本地/云端任务队列，在指定时间触发；
- 状态追踪：
  - 每个平台的状态独立显示：
    - 未发布 / 发布中 / 已发布 / 失败 / 定时等待；
  - 对于失败任务：
    - 提供错误信息（网络问题、登录失效、平台返回错误等）；
    - 提供「重试」或「切换为手动发布」选项。

### 4.4 半自动发布模式（P0，必要兜底）

- 对于无法稳定自动化的平台（例如小红书在某些时期可能没有稳定开放接口）：
  - 提供半自动方案：
    - 一键复制标题+正文+标签；
    - 打开对应平台的发文页面；
    - 引导用户粘贴并发布；
  - 用户发布后，可在创流中手动标记为「已发布」，并填写作品链接（用于后续数据抓取）。

### 4.5 与作品模型的关系（P0）

- 每一次多平台发布，应生成/更新一个统一的「作品」对象：
  - 关联：
    - 所属项目；
    - 来源 Script；
    - 各平台的发布记录（作品 ID / 链接 / 时间）。

---

## 5. 交互与体验要求

- 发布界面应突出三个区域：
  - 平台选择与整体状态；
  - 中央为当前平台的内容预览与编辑；
  - 右侧为发布选项（时间、可见范围等）；
- 一键发布/定时发布时，需有清晰的 Loading 和结果反馈；
- 出错提示要以「可操作建议」为主，而非纯技术报错信息。

---

## 6. 验收标准（v1）

- 用户从脚本工作台点击「去发布」开始，在不换工具的前提下，能够：
  - 完成至少小红书 + 公众号 两个平台的发布内容确认；
  - 成功通过创流完成至少一个平台的自动/半自动发布；
- 发布后，在作品列表中能看到：
  - 该作品下关联的各平台记录；
  - 基本发布信息（时间、平台、状态）。